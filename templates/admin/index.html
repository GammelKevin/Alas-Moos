{% extends "admin/base.html" %}

{% block content %}
<div class="admin-section">
    <h2>Öffnungszeiten verwalten</h2>
    <form method="POST" action="{{ url_for('save_opening_hours') }}" class="admin-form">
        {% for hour in opening_hours %}
        <div class="form-group">
            <h3>{{ hour.day }}</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div>
                    <label>Erste Öffnungszeit:</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="time" name="open_time_1_{{ hour.id }}" value="{{ hour.open_time_1 }}" {% if hour.closed %}disabled{% endif %}>
                        <input type="time" name="close_time_1_{{ hour.id }}" value="{{ hour.close_time_1 }}" {% if hour.closed %}disabled{% endif %}>
                    </div>
                </div>
                <div>
                    <label>Zweite Öffnungszeit:</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="time" name="open_time_2_{{ hour.id }}" value="{{ hour.open_time_2 }}" {% if hour.closed %}disabled{% endif %}>
                        <input type="time" name="close_time_2_{{ hour.id }}" value="{{ hour.close_time_2 }}" {% if hour.closed %}disabled{% endif %}>
                    </div>
                </div>
                <div style="display: flex; align-items: center;">
                    <label>
                        <input type="checkbox" name="closed_{{ hour.id }}" {% if hour.closed %}checked{% endif %} onchange="toggleTimeInputs(this, {{ hour.id }})">
                        Ruhetag
                    </label>
                </div>
            </div>
        </div>
        {% endfor %}
        <button type="submit" class="btn btn-primary">Speichern</button>
    </form>
</div>

<script>
function toggleTimeInputs(checkbox, id) {
    const timeInputs = document.querySelectorAll(`input[type="time"][name*="_${id}"]`);
    timeInputs.forEach(input => {
        input.disabled = checkbox.checked;
    });
}

document.addEventListener('DOMContentLoaded', function() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
        toggleTimeInputs(checkbox, checkbox.name.split('_')[1]);
    });
});
</script>
{% endblock %}
